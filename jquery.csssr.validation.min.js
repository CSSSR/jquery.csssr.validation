!function(t){function e(e,n,a){var i=e.data("events")||t._data(e[0]).events,r=i[n],o=a?r.splice(r.delegateCount-1,1)[0]:r.pop();r.splice(a?0:r.delegateCount||0,0,o)}function n(n,a,i){var r=a.split(/\s+/);n.each(function(){for(var n=0;n<r.length;++n){var a=t.trim(r[n]).match(/[^\.]+/i)[0];e(t(this),a,i)}})}function a(e,n){this.element=e,this.options=t.extend({},t[i].defaults,o.getDataOptions(e),n),this.init()}t.fn.onFirst=function(e,a){var i=t(this),r="string"==typeof a;if(t.fn.on.apply(i,arguments),"object"==typeof e)for(var o in e)e.hasOwnProperty(o)&&n(i,o,r);else"string"==typeof e&&n(i,e,r);return i};var i="csssrValidation",r=["valid-class","invalid-class","valid-class-target","invalid-class-target","required-selector","numeric-selector","inputmode-selector","allow-empty-selector","pattern-attribute","input-pattern-attribute","inputmode-attribute","minlength-attribute","maxlength-attribute","min-attribute","max-attribute","remove-invalid-class-on","validate-fields-on"];t[i]=t[i]||{},t[i].defaults={requiredSelector:"[required], .js-required",numericSelector:'[inputmode="numeric"]',inputmodeSelector:"input[inputmode], input[data-input-pattern], textarea[data-input-pattern]",allowEmptySelector:"[data-allow-empty]",minMaxSelector:"input[min], input[max]",patternAttribute:"pattern",inputPatternAttribute:"data-input-pattern",inputmodeAttribute:"inputmode",minlengthAttribute:"minlength",maxlengthAttribute:"maxlength",minAttribute:"min",maxAttribute:"max",removeInvalidClassOn:"focus",validateFieldsOn:!1,masks:{numbered:{has:function(t){return t.hasClass("numbered")},valid:function(t){return!t.hasClass("numbered_error")}},inputmask:{selector:"[data-inputmask]",has:function(t){return t.inputmask("getemptymask").length},valid:function(t){return t.inputmask("isComplete")},init:function(t){t.inputmask()}}},patterns:{email:/^[a-zа-яё0-9][a-zа-яё0-9\.-]*[a-zа-яё0-9]?@[a-zа-яё0-9][a-zа-яё\.-]*[a-zа-яё0-9]\.[a-zа-яё][a-zа-яё\.]*[a-z]$/i,url:/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/},inputPatterns:{cyrillic:/[а-яё\s]/i,latin:/[a-z\s]/i,numeric:/[0-9]/,letters:/[a-zа-яё\s]/i,email:/[a-zа-яё0-9\.\-_@]/i}};var o={_onSubmit:function(e){var n=t.data(e.target,i),a=o.validate.apply(n,[]);return a||e.stopImmediatePropagation(),a},_onValidateField:function(){var e=t(this),n=e.closest("form").data(i);o.validate.apply(n,[e])},_onRemoveInvalidClass:function(){var e=t(this),n=e.closest("form").data(i);o.toggleClass(e,!1,n.options.invalidClass,n.options.invalidClassTarget)},_onBlur:function(){var e=t(this),n=e.closest("form").data(i),a=e.filter(n.options.numericSelector).length,r=e.filter(n.options.requiredSelector).length,o=e.attr(n.options.minAttribute),s=e.attr(n.options.maxAttribute);a&&(r||e.val())&&(o>Number(e.val())?e.val(o):s<Number(e.val())&&e.val(s))},_onKeyDown:function(e){var n=t(this),a=n.closest("form").data(i),r=n.filter(a.options.numericSelector).length;!r||-1!==t.inArray(e.keyCode,[46,8,9,27,13,110])||65===e.keyCode&&e.ctrlKey===!0||e.keyCode>=35&&e.keyCode<=39||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()},_onKeyPress:function(e){var n=t(this),a=n.closest("form").data(i),r=o.getMask(n,a.options.masks),s=r?!1:o.getPattern.apply(a,[n,a.options.inputmodeAttribute,a.options.inputPatternAttribute,a.options.inputPatterns]),l=n.attr(a.options.maxlengthAttribute)||Number.POSITIVE_INFINITY,u=e.key||String.fromCharCode(e.which||e.keyCode);return n.val().length<=l&&(!s.length||o.matchesPatterns(u,s))},getDataOptions:function(e){var n={};return t.each(r,function(a,i){var r=e.data(i);void 0!==r&&(n[t.camelCase(i)]=r)}),n},getMask:function(e,n){for(var a in n)if(n.hasOwnProperty(a)&&void 0!==t.fn[a]&&(mask=n[a]).has(e))return mask;return!1},getPattern:function(e,n,a,i){var r=e.attr(n),o=e.attr(a),s=[],l=r?r.split(","):[];return o&&s.push(new RegExp(o)),t.each(l,function(t,e){var n="!"===e[0];void 0!==i[n?e.slice(1):e]&&s.push(n?function(t){return n===(null===t.match(new RegExp(i[e.slice(1)])))}:new RegExp(i[e]))}),s},toggleClass:function(t,e,n,a){if(n)if(a){var i=a.split("/");t[i[0]](i[1]).toggleClass(n,e)}else t.toggleClass(n,e)},matchesPatterns:function(e,n){var a=!0;return t.each(n,function(n,i){a=a&&(t.isFunction(i)?i(e):null!==e.match(i))}),a},validate:function(e){var n=this,a=t.extend({},n.options,t[i].globals||{}),r=t.grep([a.requiredSelector||"",a.numericSelector||"",a.minMaxSelector||"",a.inputmodeSelector||""],function(t){return""!==t}).join(","),s=!0;return e=e?e.filter(r):n.element.find(r),e.each(function(){var e=t(this),i=o.getDataOptions(e),r=o.getMask(e,a.masks),l=r?!1:o.getPattern.apply(n,[e,"type",a.patternAttribute,a.patterns]),u=e.filter(a.allowEmptySelector).length||!e.filter(a.requiredSelector).length,m=e.attr(a.maxlengthAttribute)||Number.POSITIVE_INFINITY,d=e.attr(a.minlengthAttribute)||0,p=e.val().length,c=e.filter(a.numericSelector).length,v=e.attr(a.minAttribute),f=e.attr(a.maxAttribute),h=(u&&!e.val()||r&&r.valid(e)||l.length&&o.matchesPatterns(e.val(),l)||!u&&!r&&!l.length&&p>0)&&p>=Number(d)&&p<=Number(m)&&(!c||(void 0===v||Number(v)<=Number(e.val()))&&(void 0===f||Number(f)>=Number(e.val())));o.toggleClass(e,!h,i.invalidClass||a.invalidClass,i.invalidClassTarget||a.invalidClassTarget),o.toggleClass(e,h,i.validClass||a.validClass,i.validClassTarget||a.validClassTarget),s=s&&h}),s}};a.prototype={init:function(){var e=this;e.element.on("keydown",e.options.numericSelector,o._onKeyDown),e.element.on("keypress",e.options.inputmodeSelector,o._onKeyPress),e.element.on("blur",e.options.minMaxSelector,o._onBlur),e.element.attr("novalidate",!0).onFirst("submit",o._onSubmit),e.options.removeInvalidClassOn&&e.element.on(e.options.removeInvalidClassOn,"input, textarea",o._onRemoveInvalidClass),e.options.validateFieldsOn&&e.element.on(e.options.validateFieldsOn,"input, textarea",o._onValidateField),t.each(e.options.masks,function(n,a){a.selector&&void 0!==t.fn[n]&&a.init(e.element.find(a.selector))})},destroy:function(){this.element.off("submit."+i,o._onSubmit).removeData(i)}},t.fn[i]=function(e){var n=arguments;return this.each(function(){var r=t.data(this,i);if(r)return e&&e.substring&&r[e].apply(r,[].splice.call(n,1)),!0;if(e&&e.substring)throw new Error(i+" not available for this DOM element!");return r=t(this),r.data(i,new a(r,e)),!0})},t("body").onFirst("submit","form[data-validate]:not([novalidate])",function(e){e.preventDefault(),e.stopImmediatePropagation(),t(this).csssrValidation().submit()}),t("form[data-validate]").csssrValidation()}(jQuery);